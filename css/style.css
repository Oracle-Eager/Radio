/* --- BASE & FONT STYLES --- */
body {
    font-family: 'Inter', sans-serif;
    overscroll-behavior-y: contain;
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    background-color: #050810;
}
.font-serif-artistic {
    font-family: 'Lora', serif;
}

/* --- "COSMIC DUST" ANIMATED BACKGROUND --- */
#background-canvas {
    position: fixed;
    inset: 0;
    z-index: -1;
    overflow: hidden;
}
#background-canvas::before {
    content: '';
    position: absolute;
    inset: -50%;
    background-image:
        radial-gradient(circle at 20% 25%, hsla(220, 50%, 30%, 0.2), transparent 40%),
        radial-gradient(circle at 80% 30%, hsla(300, 40%, 30%, 0.15), transparent 40%),
        radial-gradient(circle at 50% 80%, hsla(190, 50%, 40%, 0.2), transparent 45%);
    animation: nebula-flow 60s ease-in-out infinite;
    will-change: transform;
}
@keyframes nebula-flow {
    0%   { transform: scale(1.2) rotate(0deg); }
    50%  { transform: scale(1.6) rotate(15deg); }
    100% { transform: scale(1.2) rotate(0deg); }
}
#background-canvas::after {
    content: '';
    position: absolute;
    inset: 0;
    background-image: radial-gradient(hsla(0, 0%, 100%, 0.4) 0.5px, transparent 0);
    background-size: 100px 100px;
    animation: drift 80s linear infinite;
    will-change: transform;
}
@keyframes drift {
    from { transform: translate(0, 0); }
    to { transform: translate(-100px, 100px); }
}

/* --- FINAL "LIQUID GLASS" WAVE VISUALIZER --- */
#audio-visualizer-svg {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 25vh;
    pointer-events: none;
    z-index: 1;
    /* The SVG filter is applied here */
    filter: url(#liquid-glass);
}
#wave-path {
    transition: d 0.1s linear;
    will-change: d;
}

/* --- RE-TUNED DARK MODE GLASS DESIGN --- */
.glass-ui {
    background: rgba(15, 23, 42, 0.5);
    backdrop-filter: blur(40px);
    -webkit-backdrop-filter: blur(40px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 15px 45px rgba(0, 0, 0, 0.2), inset 0 0 0 1.5px rgba(255, 255, 255, 0.2);
}

/* --- ELITE SPLASH SCREEN ANIMATION --- */
#splash-screen {
    transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1) 3.5s;
    background-color: #050810;
}
#splash-screen.hidden { opacity: 0; pointer-events: none; }
.macro-logo { position: relative; width: 150px; height: 150px; }
.logo-core {
    position: absolute; top: 50%; left: 50%;
    font-family: 'Lora', serif; font-size: 4rem; font-weight: 600; color: #e2e8f0;
    opacity: 0; transform: translate(-50%, -50%) scale(0.8);
    animation: popIn 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) 1.8s forwards, fadeOut 0.5s ease-out 3s forwards;
}
.logo-ring {
    position: absolute; width: 100%; height: 100%;
    border-radius: 50%; border: 5px solid;
    opacity: 0;
    animation: drawAndGlow 2s cubic-bezier(0.22, 1, 0.36, 1) forwards, expandOut 1.2s cubic-bezier(0.55, 0.055, 0.675, 0.19) 2.5s forwards;
}
.logo-ring-1 { border-color: #38bdf8; animation-delay: 0.2s, 2.5s; }
.logo-ring-2 { border-color: #fb7185; animation-delay: 0.4s, 2.5s; transform: rotate(120deg); }
.logo-ring-3 { border-color: #a78bfa; animation-delay: 0.6s, 2.5s; transform: rotate(240deg); }

@keyframes drawAndGlow {
    0% { stroke-dasharray: 0, 1000; transform: rotate(0deg) scale(0.5); opacity: 0; box-shadow: none; }
    50% { opacity: 1; box-shadow: 0 0 20px -5px currentColor, 0 0 30px -10px currentColor; }
    100% { stroke-dasharray: 1000, 1000; transform: rotate(360deg) scale(1); opacity: 1; box-shadow: 0 0 25px -5px currentColor, 0 0 40px -10px currentColor; }
}
@keyframes popIn { to { transform: translate(-50%, -50%) scale(1); opacity: 1; } }
@keyframes expandOut { to { transform: rotate(360deg) scale(2); opacity: 0; } }
@keyframes fadeOut { to { opacity: 0; } }

/* --- IMPROVED IMAGE TRANSITION & KEN BURNS EFFECT --- */
.album-art-container-wrapper { will-change: transform, opacity; }
#album-art-container { position: relative; width: 100%; height: 100%; }
.album-art-img {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    object-fit: cover;
    transition: opacity 1.5s cubic-bezier(0.4, 0, 0.2, 1);
    transform: scale(1.15); opacity: 0;
    animation: kenburns 25s ease-in-out infinite alternate;
    will-change: transform, opacity;
}
.album-art-img.visible { opacity: 1; transform: scale(1); }
@keyframes kenburns {
    0% { transform: scale(1) translate(0, 0); }
    100% { transform: scale(1.15) translate(2%, -3%); }
}

/* --- UI ENTRANCE & STABILITY --- */
#macro-player.loaded .animated-item {
    animation: fadeInFromBottom 1s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    opacity: 0;
}
#macro-player.loaded .album-art-container-wrapper { animation-delay: 0.2s; }
#macro-player.loaded .station-info { animation-delay: 0.4s; }
#macro-player.loaded .controls-container { animation-delay: 0.6s; }
@keyframes fadeInFromBottom {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}
.shake-error { animation: shake 0.6s cubic-bezier(.36,.07,.19,.97) both; }
@keyframes shake {
    10%, 90% { transform: translate3d(-1px, 0, 0); } 20%, 80% { transform: translate3d(2px, 0, 0); }
    30%, 50%, 70% { transform: translate3d(-4px, 0, 0); } 40%, 60% { transform: translate3d(4px, 0, 0); }
}

#panel-content { transition: transform 0.6s cubic-bezier(0.32, 0.72, 0, 1); will-change: transform; }
.interactive-btn { transition: transform 0.2s ease, box-shadow 0.2s ease; will-change: transform; }
.interactive-btn:active { transform: scale(0.95); }
#open-panel-btn.panel-open .icon-rotate { transform: rotate(90deg); }

/* --- LIVE PLAYING INDICATOR --- */
.playing-indicator { display: flex; align-items: flex-end; gap: 2px; height: 16px; opacity: 0; transition: opacity 0.3s ease-in-out; }
.station-item.is-playing .playing-indicator { opacity: 1; }
.playing-indicator span { width: 3px; height: 100%; background-color: #3b82f6; border-radius: 2px; animation: soundwave 1.4s ease-in-out infinite alternate; }
.playing-indicator span:nth-child(2) { animation-delay: -1.0s; }
.playing-indicator span:nth-child(3) { animation-delay: -0.5s; }
@keyframes soundwave { from { transform: scaleY(0.2); } to { transform: scaleY(1); } }
